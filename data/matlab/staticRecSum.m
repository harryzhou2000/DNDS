clear;

errA0 = [...
    5.078427316878411e-02 7.132698303378887e-01 7.132693221386297e-01 7.203238637359845e+00 8.165437124209118e+00 7.202716501656410e+00
    6.337734948611155e-02 9.333781316624941e-01 9.333470353130967e-01 9.779561417614662e+00 1.048580648401833e+01 9.778922848165386e+00
    2.201291964208014e-01 2.396843700031480e+00 2.396348484576418e+00 2.499153408184793e+01 2.304293330719014e+01 2.498899776438995e+01 ];
errA1 = [...
    1.626362425595210e-03 5.603217513298381e-02 5.603400793930047e-02 1.644304897442073e+00 1.237062415469498e+00 1.644274237180118e+00
    2.026727546224483e-03 8.704849793465613e-02 8.704849680714098e-02 3.189008362049709e+00 1.549609995424315e+00 3.188997923415071e+00
    6.047530708682247e-03 4.789312503903697e-01 4.788796451610156e-01 1.889452088580943e+01 4.717065864694080e+00 1.889453277388544e+01];
errA2 = [...
     6.700186309364322e-05 4.044548634052461e-03 4.044633244899045e-03 3.165182912443557e-01 1.628603404694389e-01 3.165181705822929e-01
 1.125449226893894e-04 9.859490616468325e-03 9.859512333412595e-03 7.278136736389297e-01 2.239191146775872e-01 7.278139562815212e-01
 4.704359009082273e-04 8.549661183727841e-02 8.549606326830078e-02 5.933440486219212e+00 8.341635058776893e-01 5.933443496689918e+00];

errA3 = [...
    2.568706243726789e-06 3.318415403365883e-04 3.318447139095786e-04 6.104237717460746e-02 3.218346687037012e-02 6.104235469669937e-02
    5.398988598681939e-06 9.401106068590213e-04 9.401112361236720e-04 1.407501904428466e-01 4.947891591692296e-02 1.407502182574439e-01
    3.302574512371366e-05 1.154843341686018e-02 1.154838200663738e-02 1.561825938029514e+00 2.074592783702377e-01 1.561826167895831e+00];

errAs = {errA0,errA1,errA2,errA3};
hAs = [1,1/2,1/4,1/8];
[errAD0,errAOrder,errATable] = getStat(errAs,1,hAs);

%%
errB0 = [...
    7.045511166543597e-03 9.415999403859054e-02 9.387411285092440e-02 3.226823353990295e+00 2.523166195215791e+00 3.222124364995846e+00
    7.614683655227431e-03 1.141438081237542e-01 1.139751253469085e-01 4.662799217576997e+00 3.092352316282530e+00 4.661476305041550e+00
    1.666434985230869e-02 4.091353557079804e-01 4.197833988844799e-01 1.869769183487000e+01 7.414045469727359e+00 1.867753029605647e+01    ];

errB1 = [...
    3.824930745109357e-04 8.078476253609820e-03 7.839411683170800e-03 8.434708006571859e-01 5.393535993453350e-01 8.190669399201835e-01
    4.287843469112774e-04 1.057729160930951e-02 1.051643558499610e-02 1.331126000781534e+00 6.731346001613545e-01 1.324701618361531e+00
    1.161479277744362e-03 6.554811620456524e-02 6.422627256884894e-02 7.196043241419375e+00 1.661130557702906e+00 7.101045031573477e+00];

errB2 = [...
    1.772995249583387e-05 7.315333136990767e-04 7.290833910987258e-04 1.910405238297028e-01 1.275284379084629e-01 1.836646118878172e-01
    2.131269407784163e-05 1.074828130826311e-03 1.102299570119560e-03 3.024988586481398e-01 1.606469769310549e-01 2.930569692308442e-01
    7.129804392609629e-05 9.910375427727214e-03 9.910562414124691e-03 2.130600813593901e+00 5.064592094707940e-01 2.130770016937021e+00];
errB3 = [...
 1.006063315563042e-06 7.599814531563206e-05 7.451202324140524e-05 4.308629291911018e-02 3.160523413904137e-02 4.249029745871163e-02
 1.180705183816624e-06 1.073011428064089e-04 1.062481756640239e-04 6.204746436832773e-02 3.976841093382940e-02 6.161568595867791e-02
4.420911971668093e-06 1.283340944421285e-03 1.283335358669424e-03 5.520846568479243e-01 1.395290279872801e-01 5.521283106670865e-01];

errBs = {errB0,errB1,errB2,errB3};
hBs = [1,1/2,1/4,1/8];
[~,~,errBTable] = getStat(errBs,1,hBs);

function [errAD0, errAOrder,table] = getStat(errAs,idiff,hs)
hs = reshape(hs,[],1);
errAD0 = nan(numel(errAs),3);
for i = 1:numel(errAs)
   errAD0(i,:) = errAs{i}(:,idiff)';
end
errAOrder = log(errAD0(1:end-1,:)./errAD0(2:end,:))./log(hs(1:end-1,:)./hs(2:end,:));
errAOrder = [zeros(1,3);errAOrder];
table = [errAD0(:,1),errAOrder(:,1),errAD0(:,2),errAOrder(:,2),errAD0(:,3),errAOrder(:,3)];
end
